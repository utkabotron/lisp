# AutoCAD LISP Scripts Collection - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–ö–æ–ª–ª–µ–∫—Ü–∏—è AutoCAD LISP —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –≥–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –±–ª–æ–∫–∞–º–∏, –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –∏ —Ç–æ—á–∫–∞–º–∏. –ü—Ä–æ–µ–∫—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –ø–æ –º–æ–¥—É–ª—å–Ω–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É —Å –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.

**–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `c:\1\`
**–í–µ—Ä—Å–∏—è:** 2.0 (–Ø–Ω–≤–∞—Ä—å 2026)
**–§–æ—Ä–º–∞—Ç:** AutoCAD LISP (LSP) + DCL

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏

```
MainLoader.lsp (–≥–ª–∞–≤–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫)
‚îÇ
‚îú‚îÄ‚îÄ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–∏ (*main-lsp-dir*)
‚îú‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π (*lsp-files*)
‚îî‚îÄ‚îÄ –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ (c:LoadAllLSP)
    ‚îÇ
    ‚îî‚îÄ‚îÄ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –º–æ–¥—É–ª–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
```

### –ü–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π

```
1. HK_Hotkeys.lsp                        ‚Üê –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
2. BL_Block_Tools.lsp                    ‚Üê 3D –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –±–ª–æ–∫–∞–º–∏
3. BL_Copy_Attributes_Properties.lsp     ‚Üê –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
4. BL_Delete_Duplicate_Blocks.lsp        ‚Üê –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
5. BL_Select_Blocks_On_Line.lsp          ‚Üê –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ –Ω–∞ –ª–∏–Ω–∏–∏
6. BL_Insert_Block_To_Points.lsp         ‚Üê –í—Å—Ç–∞–≤–∫–∞ M1502 (–∫–ª—é—á–µ–≤–æ–π –º–æ–¥—É–ª—å)
7. AT_Attribute_Tools.lsp                ‚Üê –†–∞–±–æ—Ç–∞ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
8. AT_Attribute_Visibility.lsp           ‚Üê DCL –¥–∏–∞–ª–æ–≥ –≤–∏–¥–∏–º–æ—Å—Ç–∏
9. PT_Point_Tools.lsp                    ‚Üê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ—á–µ–∫
10. PT_Points_Intersection.lsp           ‚Üê –¢–æ—á–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
11. PT_Point_At_Block_Center.lsp         ‚Üê –¢–æ—á–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –±–ª–æ–∫–æ–≤
12. DV_Deviation_Tools.lsp               ‚Üê –†–∞—Å—á–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π
13. LY_Set_All_By_Layer.lsp              ‚Üê ByLayer –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
14. LY_Xref_Layers.lsp                   ‚Üê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ XREF —Å–ª–æ—è–º–∏
15. UT_Export_To_CSV.lsp                 ‚Üê –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/Excel
```

---

## üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ñ–∞–π–ª–æ–≤ (–ü—Ä–µ—Ñ–∏–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)

### HK_ - Hotkeys (–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏)

**–§–∞–π–ª:** `HK_Hotkeys.lsp`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ—Ä–æ—Ç–∫–∏–µ –æ–±–µ—Ä—Ç–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ AutoCAD

| –ö–æ–º–∞–Ω–¥–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ |
|---------|-----------|----------------------|
| `CT` | –û–∫—Ä—É–∂–Ω–æ—Å—Ç—å –ø–æ 3 —Ç–æ—á–∫–∞–º | `.circle 3P` |
| `PC` | –ü–ª–∞–Ω –≤–∏–¥–∞ —Å–≤–µ—Ä—Ö—É | `PLAN C` |
| `BRF` | –†–∞–∑—Ä—ã–≤ –ª–∏–Ω–∏–∏ –æ—Ç –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏ | `.BREAK F` |
| `VC` | –í—Å—Ç–∞–≤–∫–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞ –≤ –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã | `PASTEORIG` |
| `VCX` | –í—Å—Ç–∞–≤–∫–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞ + –ø–ª–∞–Ω | `PASTEORIG` + `PLAN` |
| `rv` | –†–∞–∑–≤–æ—Ä–æ—Ç –ø–æ–ª–∏–ª–∏–Ω–∏–∏ | `REVERSE` |
| `cc` | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ | `COPY` |
| `hi` | –°–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã (VBA) | `.-vbarun Hideshowatts` |
| `MM` | –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (VBA) | `.-vbarun MoveMultiplyBlocksAttributes` |
| `RB` | –ü–æ–≤–æ—Ä–æ—Ç –±–ª–æ–∫–æ–≤ (VBA) | `.-vbarun rotateblocks` |

---

### BL_ - Block Tools (–†–∞–±–æ—Ç–∞ —Å –±–ª–æ–∫–∞–º–∏)

#### `BL_Block_Tools.lsp` - 3D –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ (`ssget` —Å —Ñ–∏–ª—å—Ç—Ä–æ–º INSERT)
2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ (DXF –∫–æ–¥ 10)
3. –ü–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –æ—Å–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|---------|----------|------------|
| `RX90` | –ü–æ–≤–æ—Ä–æ—Ç –Ω–∞ 90¬∞ –≤–æ–∫—Ä—É–≥ –æ—Å–∏ X | 3D –º–æ–¥–µ–ª–∏, –±–æ–∫–æ–≤—ã–µ –≤–∏–¥—ã |
| `RY90` | –ü–æ–≤–æ—Ä–æ—Ç –Ω–∞ 90¬∞ –≤–æ–∫—Ä—É–≥ –æ—Å–∏ Y | 3D –º–æ–¥–µ–ª–∏, —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –≤–∏–¥—ã |
| `PB3` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Z –∏–∑ 3D –ø–æ–ª–∏–ª–∏–Ω–∏–∏ | –ü–µ—Ä–µ–Ω–æ—Å –≤—ã—Å–æ—Ç –Ω–∞ –±–ª–æ–∫–∏ |

**–§—É–Ω–∫—Ü–∏–∏:**
- `vlax-curve-getClosestPointTo` - –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–µ–π —Ç–æ—á–∫–∏ –Ω–∞ 3D –ø–æ–ª–∏–ª–∏–Ω–∏–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ Z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Å—Ç–∞–≤–∫–∏ –±–ª–æ–∫–∞

---

#### `BL_Copy_Attributes_Properties.lsp` - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

**–ö–æ–º–∞–Ω–¥–∞: COPYATTPROP**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–≤–æ–π—Å—Ç–≤ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –º–∞—Å—à—Ç–∞–±–∞ –±–ª–æ–∫–∞ —Å –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞-–æ–±—Ä–∞–∑—Ü–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ü–µ–ª–µ–≤—ã—Ö –±–ª–æ–∫–æ–≤.

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –í—ã–±–æ—Ä –±–ª–æ–∫–∞-–æ–±—Ä–∞–∑—Ü–∞ (source block):
   ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ (INSERT)
   ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
   ‚îî‚îÄ‚îÄ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤:
       ‚îú‚îÄ‚îÄ –ê—Ç—Ä–∏–±—É—Ç—ã (GetAttributes)
       ‚îú‚îÄ‚îÄ –¢–æ—á–∫–∞ –≤—Å—Ç–∞–≤–∫–∏ (InsertionPoint)
       ‚îú‚îÄ‚îÄ –£–≥–æ–ª –ø–æ–≤–æ—Ä–æ—Ç–∞ (Rotation)
       ‚îî‚îÄ‚îÄ –ú–∞—Å—à—Ç–∞–± (XScaleFactor)

2. –í—ã–±–æ—Ä —Ü–µ–ª–µ–≤—ã—Ö –±–ª–æ–∫–æ–≤ (target blocks):
   ‚îî‚îÄ‚îÄ –§–∏–ª—å—Ç—Ä: —Ç–æ–ª—å–∫–æ INSERT

3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îú‚îÄ‚îÄ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞ –±–ª–æ–∫–∞ (X, Y, Z)
   ‚îî‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞:
       ‚îú‚îÄ‚îÄ –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏:
       ‚îÇ   ‚îú‚îÄ‚îÄ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ –±–ª–æ–∫–∞
       ‚îÇ   ‚îú‚îÄ‚îÄ –£–≥–ª–æ–≤–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤–æ—Ä–æ—Ç–∞ –±–ª–æ–∫–∞
       ‚îÇ   ‚îî‚îÄ‚îÄ –ü–µ—Ä–µ—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º –ø–æ–≤–æ—Ä–æ—Ç–∞ —Ü–µ–ª–µ–≤–æ–≥–æ –±–ª–æ–∫–∞
       ‚îú‚îÄ‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø–æ–≤–æ—Ä–æ—Ç–∞
       ‚îî‚îÄ‚îÄ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤:
           ‚îú‚îÄ‚îÄ Height (–≤—ã—Å–æ—Ç–∞ —Ç–µ–∫—Å—Ç–∞)
           ‚îú‚îÄ‚îÄ ScaleFactor (–º–∞—Å—à—Ç–∞–± —à–∏—Ä–∏–Ω—ã)
           ‚îú‚îÄ‚îÄ ObliqueAngle (—É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞)
           ‚îú‚îÄ‚îÄ Alignment (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ)
           ‚îú‚îÄ‚îÄ Layer (—Å–ª–æ–π)
           ‚îú‚îÄ‚îÄ StyleName (—Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞)
           ‚îú‚îÄ‚îÄ Invisible (–≤–∏–¥–∏–º–æ—Å—Ç—å)
           ‚îî‚îÄ‚îÄ Color (—Ü–≤–µ—Ç)

4. –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä—Ç–µ–∂–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç –ø–æ–∑–∏—Ü–∏–π:** –ê—Ç—Ä–∏–±—É—Ç—ã —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–∞–∂–µ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —É–≥–ª–∞—Ö –ø–æ–≤–æ—Ä–æ—Ç–∞ –±–ª–æ–∫–æ–≤
- **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –ú–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ä–∞–∑—É –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏:** –†–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ —É–≥–ª—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ –±–ª–æ–∫–∞
- **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞:** –ò–∑–º–µ–Ω—è–µ—Ç XYZ –º–∞—Å—à—Ç–∞–± —Ü–µ–ª–µ–≤—ã—Ö –±–ª–æ–∫–æ–≤

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –±–ª–æ–∫–æ–≤
- –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª—è —Ç–µ–∫—Å—Ç–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏

**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `dist2d` - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ –≤ 2D
- `calc-angle` - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —É–≥–ª–∞ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
- `copy-attribute-properties` - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –æ–¥–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ —Å –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º –≥–µ–æ–º–µ—Ç—Ä–∏–∏

---

#### `BL_Delete_Duplicate_Blocks.lsp` - –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±–ª–æ–∫–∏ –≤ —á–µ—Ä—Ç–µ–∂–µ (ssget "_X")
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   - –ò–∑–≤–ª–µ—á—å —Ç–æ—á–∫—É –≤—Å—Ç–∞–≤–∫–∏ (–∫–æ–¥ 10)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –æ–Ω–∞ –≤ —Å–ø–∏—Å–∫–µ seen
   - –ï—Å–ª–∏ –¥–∞ ‚Üí —É–¥–∞–ª–∏—Ç—å (entdel)
   - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ seen
3. –í—ã–≤–µ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö
```

| –ö–æ–º–∞–Ω–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|----------|
| `DelDupBlocks` | –£–¥–∞–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (XYZ) |

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –±–µ–∑ —Ç–æ–ª–µ—Ä–∞–Ω—Å–∞ (tolerance).

---

#### `BL_Select_Blocks_On_Line.lsp` - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—É–≥ (bulge) –≤ –ø–æ–ª–∏–ª–∏–Ω–∏—è—Ö
- –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä (accumulative selection)
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `*sbp-selection*`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –í—ã–±–æ—Ä –ø–æ–ª–∏–ª–∏–Ω–∏–∏/–ª–∏–Ω–∏–∏
2. –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã (LINE/ARC)
3. –î–ª—è –¥—É–≥: –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ bulge ‚Üí —Ü–µ–Ω—Ç—Ä, —Ä–∞–¥–∏—É—Å, —É–≥–ª—ã
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ –≤ —á–µ—Ä—Ç–µ–∂–µ:
   - point-on-line-seg (–¥–ª—è –ª–∏–Ω–∏–π)
   - point-on-arc-seg (–¥–ª—è –¥—É–≥)
5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π selection set
6. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—Å–µ—Ö –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
```

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `SBP` | –í—ã–±—Ä–∞—Ç—å –±–ª–æ–∫–∏ –Ω–∞ –ª–∏–Ω–∏–∏/–ø–æ–ª–∏–ª–∏–Ω–∏–∏ (–º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å) |
| `SBPC` | –û—á–∏—Å—Ç–∏—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä |

**–§—É–Ω–∫—Ü–∏–∏:**
- `bulge-to-arc` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ bulge –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥—É–≥–∏
- `point-on-segment` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–∫–∏ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–µ
- `angle-in-arc` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–≥–ª–∞ –≤–Ω—É—Ç—Ä–∏ –¥—É–≥–∏ (CCW/CW)

**–¢–æ–ª–µ—Ä–∞–Ω—Å:** `tol = 0.1` (–¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç)

---

#### `BL_Insert_Block_To_Points.lsp` - –ö–ª—é—á–µ–≤–æ–π –º–æ–¥—É–ª—å (POP)

**–°–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–æ–µ–∫—Ç–∞.**

**–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `*POP-LAST-NUM*` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä (persistence –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏)
- `*POP-CIRCLE-MODE*` - —Ä–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π ("A"/"C"/"Q")
- `*CIRCLE-MODE-ASKED*` - —Ñ–ª–∞–≥ –∑–∞–ø—Ä–æ—Å–∞ —Ä–µ–∂–∏–º–∞ (–≤–Ω—É—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥—ã)

**–ë–ª–æ–∫ M1502:**
- –ü—É—Ç—å: `C:\LDOCS\BLOCKS\M1502.dwg`
- –ê—Ç—Ä–∏–±—É—Ç—ã: NUMBER (–Ω–æ–º–µ—Ä), HEIGHT (Z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞)
- –°–ª–æ–π: M1502 (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

**–ê–ª–≥–æ—Ä–∏—Ç–º –∫–æ–º–∞–Ω–¥—ã POP:**
```
1. –ó–∞–ø—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
   ‚îú‚îÄ‚îÄ Starting number (—Å –æ–ø—Ü–∏—è–º–∏ Prefix/Suffix)
   ‚îú‚îÄ‚îÄ Prefix (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ‚îî‚îÄ‚îÄ Suffix (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞:
   ‚îî‚îÄ‚îÄ get-block-scale() ‚Üí –º–∞—Å—à—Ç–∞–± –ø–æ CANNOSCALE
       ‚îú‚îÄ‚îÄ 1:2000 ‚Üí 1.44
       ‚îú‚îÄ‚îÄ 1:1000 ‚Üí 0.72
       ‚îú‚îÄ‚îÄ 1:500  ‚Üí 0.36
       ‚îî‚îÄ‚îÄ ...

3. –ü—Ä–æ–≤–µ—Ä–∫–∞/–∑–∞–≥—Ä—É–∑–∫–∞ –±–ª–æ–∫–∞ M1502:
   ‚îú‚îÄ‚îÄ tblsearch "BLOCK" "M1502"
   ‚îú‚îÄ‚îÄ –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ C:\LDOCS\BLOCKS\M1502.dwg
   ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –∑–∞–ø—Ä–æ—Å –ø—É—Ç–∏ (getfiled)

4. –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—è M1502

5. –í—ã–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤:
   ‚îî‚îÄ‚îÄ POINT, LINE, LWPOLYLINE, POLYLINE, CIRCLE

6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞:
   ‚îú‚îÄ‚îÄ POINT ‚Üí process-point
   ‚îú‚îÄ‚îÄ LINE ‚Üí process-line (2 –±–ª–æ–∫–∞: start + end)
   ‚îú‚îÄ‚îÄ LWPOLYLINE ‚Üí process-lwpolyline (–ø–æ –≤–µ—Ä—à–∏–Ω–∞–º)
   ‚îú‚îÄ‚îÄ POLYLINE ‚Üí process-polyline (—á–µ—Ä–µ–∑ VERTEX)
   ‚îî‚îÄ‚îÄ CIRCLE ‚Üí process-circle-insblp
       ‚îú‚îÄ‚îÄ –ó–∞–ø—Ä–æ—Å —Ä–µ–∂–∏–º–∞ (–ø–µ—Ä–≤—ã–π —Ä–∞–∑):
       ‚îÇ   ‚îú‚îÄ‚îÄ All ‚Üí —Ü–µ–Ω—Ç—Ä + 4 –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞ (5 –±–ª–æ–∫–æ–≤)
       ‚îÇ   ‚îú‚îÄ‚îÄ Center ‚Üí —Ç–æ–ª—å–∫–æ —Ü–µ–Ω—Ç—Ä (1 –±–ª–æ–∫)
       ‚îÇ   ‚îî‚îÄ‚îÄ Quadrants ‚Üí 4 –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞ (4 –±–ª–æ–∫–∞)
       ‚îî‚îÄ‚îÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∫–æ –≤—Å–µ–º –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—è–º

7. –í—Å—Ç–∞–≤–∫–∞ –±–ª–æ–∫–æ–≤:
   ‚îî‚îÄ‚îÄ insert-block-with-attribs
       ‚îú‚îÄ‚îÄ –í—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ vla-InsertBlock
       ‚îú‚îÄ‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ—è M1502
       ‚îî‚îÄ‚îÄ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤:
           ‚îú‚îÄ‚îÄ HEIGHT/H/Z ‚Üí Z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ (2 –∑–Ω–∞–∫–∞)
           ‚îî‚îÄ‚îÄ NUMBER/NUM/N ‚Üí prefix + —á–∏—Å–ª–æ + suffix
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ù—É–º–µ—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π:** –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è "C" –≤ suffix
- **–ú–∞—Å—à—Ç–∞–±:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ CANNOSCALEVALUE
- **Previous:** –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–±–æ—Ä
- **Escape handling:** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã

**–§—É–Ω–∫—Ü–∏–∏:**
| –§—É–Ω–∫—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|-----------|
| `get-block-scale` | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∞ –ø–æ –∞–Ω–Ω–æ—Ç–∞—Ç–∏–≤–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É |
| `get-or-load-block` | –ü—Ä–æ–≤–µ—Ä–∫–∞/–∑–∞–≥—Ä—É–∑–∫–∞ –±–ª–æ–∫–∞ M1502 |
| `create-layer` | –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—è —á–µ—Ä–µ–∑ VLA |
| `process-point` | –í—Å—Ç–∞–≤–∫–∞ –±–ª–æ–∫–∞ –Ω–∞ —Ç–æ—á–∫–µ |
| `process-line` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏–Ω–∏–∏ (2 —Ç–æ—á–∫–∏) |
| `process-lwpolyline` | –û–±—Ä–∞–±–æ—Ç–∫–∞ 2D –ø–æ–ª–∏–ª–∏–Ω–∏–∏ |
| `process-polyline` | –û–±—Ä–∞–±–æ—Ç–∫–∞ 3D –ø–æ–ª–∏–ª–∏–Ω–∏–∏ (—á–µ—Ä–µ–∑ VERTEX) |
| `process-circle-insblp` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ —Å —Ä–µ–∂–∏–º–∞–º–∏ |
| `insert-block-with-attribs` | –í—Å—Ç–∞–≤–∫–∞ –±–ª–æ–∫–∞ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∞—Ç—Ä–∏–±—É—Ç–æ–≤ |

---

### AT_ - Attribute Tools (–†–∞–±–æ—Ç–∞ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏)

#### `AT_Attribute_Tools.lsp`

**–ö–æ–º–∞–Ω–¥—ã:**

**1. SetAttFromText**
```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –±–ª–æ–∫–∞ (entsel)
2. –í—ã–±–æ—Ä —Ç–µ–∫—Å—Ç–∞ (TEXT/MTEXT)
3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ (DXF –∫–æ–¥ 1)
4. –ü–æ–∏—Å–∫ –∞—Ç—Ä–∏–±—É—Ç–∞ HEIGHT –≤ –±–ª–æ–∫–µ:
   ‚îî‚îÄ‚îÄ –ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º ATTRIB –ø–æ—Å–ª–µ INSERT
5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞
6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (entupd)
```

**2. AttToZMulti**
```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ (ssget —Å —Ñ–∏–ª—å—Ç—Ä–æ–º INSERT)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îú‚îÄ‚îÄ –ü–æ–∏—Å–∫ –∞—Ç—Ä–∏–±—É—Ç–∞ HEIGHT
   ‚îú‚îÄ‚îÄ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞)
   ‚îú‚îÄ‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —á–∏—Å–ª–æ:
   ‚îÇ   ‚îú‚îÄ‚îÄ distof —Å —Ä–µ–∂–∏–º–æ–º 2 (decimal)
   ‚îÇ   ‚îî‚îÄ‚îÄ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—è—Ç–æ–π –∏ —Ç–æ—á–∫–∏
   ‚îú‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ (DXF –∫–æ–¥ 10):
   ‚îÇ   ‚îî‚îÄ‚îÄ –ó–∞–º–µ–Ω–∞ Z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∞—Ç—Ä–∏–±—É—Ç–∞
   ‚îî‚îÄ‚îÄ entmod + entupd
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π –∑–∞–ø—è—Ç–æ–π –∏ —Ç–æ—á–∫–∏ (–∑–∞–º–µ–Ω–∞ "," –Ω–∞ ".")
- –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –±–ª–æ–∫–æ–≤
- –¶–µ–ª–µ–≤–æ–π –∞—Ç—Ä–∏–±—É—Ç: `HEIGHT`

---

#### `AT_Attribute_Visibility.lsp` + `.dcl`

**DCL –¥–∏–∞–ª–æ–≥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∞—Ç—Ä–∏–±—É—Ç–æ–≤.**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
Dialog: attribute_visibility
‚îú‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (list_box)
‚îÇ   ‚îú‚îÄ‚îÄ multiple_select = true
‚îÇ   ‚îî‚îÄ‚îÄ –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
‚îî‚îÄ‚îÄ –ö–Ω–æ–ø–∫–∏:
    ‚îú‚îÄ‚îÄ Visible ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å :vlax-false
    ‚îú‚îÄ‚îÄ Invisible ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å :vlax-true
    ‚îî‚îÄ‚îÄ Exit ‚Üí –∑–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ (ssget —Å —Ñ–∏–ª—å—Ç—Ä–æ–º INSERT)
2. –°–±–æ—Ä –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤:
   ‚îî‚îÄ‚îÄ collect-attributes
       ‚îú‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
       ‚îî‚îÄ‚îÄ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ TagString –≤ —Å–ø–∏—Å–æ–∫ (–±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
3. –ó–∞–≥—Ä—É–∑–∫–∞ DCL —Ñ–∞–π–ª–∞
4. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ (start_list/add_list)
5. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫:
   ‚îú‚îÄ‚îÄ get_tile "attr_list" ‚Üí –∏–Ω–¥–µ–∫—Å—ã –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
   ‚îú‚îÄ‚îÄ get-selected-items ‚Üí –∏–º–µ–Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
   ‚îî‚îÄ‚îÄ set-attribute-visibility
       ‚îú‚îÄ‚îÄ vla-put-Invisible (T/nil)
       ‚îî‚îÄ‚îÄ vla-Regen acAllViewports
6. –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞
```

**–§–∞–π–ª—ã:**
- `AT_Attribute_Visibility.lsp` - –ª–æ–≥–∏–∫–∞
- `AT_Attribute_Visibility.dcl` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

### PT_ - Point Tools (–†–∞–±–æ—Ç–∞ —Å —Ç–æ—á–∫–∞–º–∏)

#### `PT_Point_Tools.lsp`

**–ö–æ–º–∞–Ω–¥—ã:**

| –ö–æ–º–∞–Ω–¥–∞ | PDMODE | PDSIZE | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|--------|----------|
| `PTT` | 99 | 0.3 | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å (–∫–≤–∞–¥—Ä–∞—Ç+–∫—Ä—É–≥+–∫—Ä–µ—Å—Ç) |
| `PTTT` | 99 | user input | –°—Ç–∏–ª—å —Å –≤—ã–±–æ—Ä–æ–º —Ä–∞–∑–º–µ—Ä–∞ + REGEN |

**PDMODE = 99:**
- –ö–≤–∞–¥—Ä–∞—Ç (32)
- –ö—Ä—É–≥ (64)
- –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π –∫—Ä–µ—Å—Ç (3)
- –°—É–º–º–∞: 32 + 64 + 3 = 99

**TXT2PT - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ 3D —Ç–æ—á–∫–∏**
```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤ (ssget —Å —Ñ–∏–ª—å—Ç—Ä–æ–º TEXT)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ–∫—Å—Ç–∞:
   ‚îú‚îÄ‚îÄ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ (DXF –∫–æ–¥ 10) ‚Üí X, Y
   ‚îú‚îÄ‚îÄ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (DXF –∫–æ–¥ 1) ‚Üí Z
   ‚îú‚îÄ‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —á–∏—Å–ª–æ (atof)
   ‚îî‚îÄ‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏:
       ‚îî‚îÄ‚îÄ entmake (0 . "POINT") + (10 . (X Y Z))
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ü–µ—Ä–µ–Ω–æ—Å –≤—ã—Å–æ—Ç–Ω—ã—Ö –æ—Ç–º–µ—Ç–æ–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –≤ 3D —Ç–æ—á–∫–∏.

---

#### `PT_Points_Intersection.lsp`

**–ö–æ–º–∞–Ω–¥–∞: PTSINT**

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π:**
```
1. –í—ã–±–æ—Ä –ø–æ–ª–∏–ª–∏–Ω–∏–π (LWPOLYLINE/POLYLINE)

2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:
   ‚îî‚îÄ‚îÄ get-polyline-coords
       ‚îú‚îÄ‚îÄ vlax-get 'Coordinates
       ‚îú‚îÄ‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ variant/safearray
       ‚îî‚îÄ‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫

3. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –≤–µ—Ä—à–∏–Ω—ã:
   ‚îî‚îÄ‚îÄ coords-to-verts
       ‚îú‚îÄ‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —à–∞–≥–∞ (2D=2, 3D=3)
       ‚îî‚îÄ‚îÄ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ X,Y

4. –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã:
   ‚îî‚îÄ‚îÄ verts-to-segments
       ‚îî‚îÄ‚îÄ –ü–∞—Ä—ã —Ç–æ—á–µ–∫ [(p1 p2), (p3 p4), ...]

5. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä –ø–æ–ª–∏–ª–∏–Ω–∏–π:
   ‚îî‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã —Å–µ–≥–º–µ–Ω—Ç–æ–≤:
       ‚îú‚îÄ‚îÄ seg-intersect (–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ 2D –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è)
       ‚îú‚îÄ‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ t,u –≤ [0,1]
       ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ:
           ‚îú‚îÄ‚îÄ point-in-list-p (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
           ‚îî‚îÄ‚îÄ create-point (entmake)

6. –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
   ‚îú‚îÄ‚îÄ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤
   ‚îî‚îÄ‚îÄ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫
```

**–§—É–Ω–∫—Ü–∏–∏:**
- `seg-intersect` - –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –¥–≤—É—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤ (–ª–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞)
- `point-in-list-p` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å —Ç–æ–ª–µ—Ä–∞–Ω—Å–æ–º
- `coords-to-verts` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–ª–æ—Å–∫–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ —Ç–æ—á–∫–∏
- `verts-to-segments` - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã

**–¢–æ–ª–µ—Ä–∞–Ω—Å:** `tol = 1e-6` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—è, `1e-5` –¥–ª—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

---

#### `PT_Point_At_Block_Center.lsp`

**–ö–æ–º–∞–Ω–¥—ã:**

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `PTBC` | –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ |
| `PTBCM` | –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–µ–∫ –≤ —Ü–µ–Ω—Ç—Ä–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –±–ª–æ–∫–æ–≤ |

**PTBC - Point To Block Center (–æ–¥–∏–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º)**
```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ (entsel)
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–∞ (INSERT)
3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ –±–ª–æ–∫–∞ (InsertionPoint)
4. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ variant ‚Üí —Å–ø–∏—Å–æ–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
5. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ —á–µ—Ä–µ–∑ entmake:
   ‚îî‚îÄ‚îÄ (0 . "POINT") + (10 . coordinates)
6. –í—ã–≤–æ–¥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Ç–æ—á–∫–∏
```

**PTBCM - Point To Block Center Multiple (–ø–∞–∫–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º)**
```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –±–ª–æ–∫–æ–≤ (ssget —Å —Ñ–∏–ª—å—Ç—Ä–æ–º INSERT)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îú‚îÄ‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ InsertionPoint
   ‚îú‚îÄ‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
   ‚îî‚îÄ‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏
3. –í—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø–æ—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–ª—è –≥–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—Ç—Ä–æ–≤ –±–ª–æ–∫–æ–≤ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –¢–æ—á–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Ç–æ—á–∫–µ –≤—Å—Ç–∞–≤–∫–∏ –±–ª–æ–∫–∞ (InsertionPoint), –∞ –Ω–µ –≤ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–º —Ü–µ–Ω—Ç—Ä–µ
- –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Å–µ 3 –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (X, Y, Z)
- –ü–∞–∫–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑

---

### DV_ - Deviation Tools (–†–∞—Å—á–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π)

#### `DV_Deviation_Tools.lsp`

**–ì–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π.**

**1. SetDeltaDAL - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –ª–∏–Ω–∏–∏/–¥—É–≥–∏/—Å–ø–ª–∞–π–Ω–∞**

```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤
2. –í—ã–±–æ—Ä –æ–ø–æ—Ä–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (LINE/POLYLINE/ARC/SPLINE/CIRCLE)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îú‚îÄ‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Å—Ç–∞–≤–∫–∏ (InsertionPoint)
   ‚îú‚îÄ‚îÄ xy-only ‚Üí –ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ XY (Z=0)
   ‚îú‚îÄ‚îÄ vlax-curve-getClosestPointTo ‚Üí –±–ª–∏–∂–∞–π—à–∞—è —Ç–æ—á–∫–∞ –Ω–∞ –∫—Ä–∏–≤–æ–π
   ‚îú‚îÄ‚îÄ distance (XY only) ‚Üí —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –º–µ—Ç—Ä–∞—Ö
   ‚îú‚îÄ‚îÄ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: fmt2 ‚Üí –≤—Å–µ–≥–¥–∞ 2 –∑–Ω–∞–∫–∞
   ‚îÇ   ‚îî‚îÄ‚îÄ "Œî‚î¥=0.00" (Unicode: \U+0394\U+2534)
   ‚îî‚îÄ‚îÄ –ó–∞–ø–∏—Å—å –≤ –∞—Ç—Ä–∏–±—É—Ç DELTA
```

**–§–æ—Ä–º–∞—Ç:** `Œî‚î¥=0.05` (–≤—Å–µ–≥–¥–∞ 2 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)

---

**2. SetDeltaDAL_CIRCLE - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏**

```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤
2. –í—ã–±–æ—Ä –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ CIRCLE)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îú‚îÄ‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –∏ —Ä–∞–¥–∏—É—Å–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏
   ‚îú‚îÄ‚îÄ xy-only ‚Üí –ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ XY
   ‚îú‚îÄ‚îÄ distance (—Ç–æ—á–∫–∞ ‚Üí —Ü–µ–Ω—Ç—Ä) ‚Üí dPC
   ‚îú‚îÄ‚îÄ –†–∞—Å—á–µ—Ç —Å–º–µ—â–µ–Ω–∏—è: off = dPC - radius
   ‚îú‚îÄ‚îÄ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:
   ‚îÇ   ‚îú‚îÄ‚îÄ |off| < tol ‚Üí "Œî‚î¥=0.00" (–Ω–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏)
   ‚îÇ   ‚îú‚îÄ‚îÄ off > 0 ‚Üí "Œî‚î¥=+0.xx" (—Å–Ω–∞—Ä—É–∂–∏)
   ‚îÇ   ‚îî‚îÄ‚îÄ off < 0 ‚Üí "Œî‚î¥=-0.xx" (–≤–Ω—É—Ç—Ä–∏)
   ‚îî‚îÄ‚îÄ –ó–∞–ø–∏—Å—å –≤ –∞—Ç—Ä–∏–±—É—Ç DELTA
```

**–¢–æ–ª–µ—Ä–∞–Ω—Å:** `tol = 1e-6`

**–§–æ—Ä–º–∞—Ç:**
- –°–Ω–∞—Ä—É–∂–∏: `Œî‚î¥=+0.05`
- –í–Ω—É—Ç—Ä–∏: `Œî‚î¥=-0.03`
- –ù–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏: `Œî‚î¥=0.00`

---

**3. SetDelta_Point - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –æ–ø–æ—Ä–Ω–æ–π —Ç–æ—á–∫–∏**

```
–ê–ª–≥–æ—Ä–∏—Ç–º:
1. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤
2. –í—ã–±–æ—Ä –æ–ø–æ—Ä–Ω–æ–π —Ç–æ—á–∫–∏ (POINT)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞:
   ‚îú‚îÄ‚îÄ deltaX = block.X - point.X
   ‚îú‚îÄ‚îÄ deltaY = block.Y - point.Y
   ‚îú‚îÄ‚îÄ –ó–∞–ø–∏—Å—å –≤ –∞—Ç—Ä–∏–±—É—Ç—ã:
   ‚îÇ   ‚îú‚îÄ‚îÄ DELTA_X ‚Üí "\U+0394E=1.05" (ŒîE = East)
   ‚îÇ   ‚îî‚îÄ‚îÄ DELTA_Y ‚Üí "\U+0394N=0.14" (ŒîN = North)
```

**–§–æ—Ä–º–∞—Ç:**
- `ŒîE=1.05` (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ X, 2 –∑–Ω–∞–∫–∞)
- `ŒîN=0.14` (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ Y, 2 –∑–Ω–∞–∫–∞)

---

**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `xy-only` - –ø—Ä–æ–µ–∫—Ü–∏—è —Ç–æ—á–∫–∏ –Ω–∞ XY (–æ–±–Ω—É–ª–µ–Ω–∏–µ Z)
- `fmt2` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞ —Å —Ä–æ–≤–Ω–æ 2 –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ —Ç–æ—á–∫–∏
- `abs1` - –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

---

### LY_ - Layer Tools (–†–∞–±–æ—Ç–∞ —Å–æ —Å–ª–æ—è–º–∏)

#### `LY_Set_All_By_Layer.lsp`

**–ö–æ–º–∞–Ω–¥–∞: SetAllByLayer**

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ ByLayer:**
```
1. SetAllByLayer-AllEnts (–≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –≤ —á–µ—Ä—Ç–µ–∂–µ):
   ‚îú‚îÄ‚îÄ ssget "X" ‚Üí –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã
   ‚îú‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞:
   ‚îÇ   ‚îú‚îÄ‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ ‚Üí 256 (BYLAYER)
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è DXF –∫–æ–¥–∞ 62
   ‚îÇ   ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ INSERT ‚Üí —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–ª–æ–∫–∞

2. SetAllByLayer-Blocks (–≤—Å–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±–ª–æ–∫–æ–≤):
   ‚îú‚îÄ‚îÄ tblnext "BLOCK" ‚Üí –≤—Å–µ –±–ª–æ–∫–∏
   ‚îú‚îÄ‚îÄ –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö/XREF (*|*)
   ‚îî‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ ‚Üí —Ä–µ–∫—É—Ä—Å–∏—è

3. SetAllByLayer-Blocks-Recursive (–≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞):
   ‚îú‚îÄ‚îÄ tblobjname "BLOCK" ‚Üí –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç
   ‚îú‚îÄ‚îÄ entnext ‚Üí –ø—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º –æ–±—ä–µ–∫—Ç–∞–º
   ‚îú‚îÄ‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ ‚Üí 256
   ‚îî‚îÄ‚îÄ –ï—Å–ª–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–π INSERT ‚Üí —Ä–µ–∫—É—Ä—Å–∏—è
```

**–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
- –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –º–æ–¥–µ–ª–∏
- –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ)

**–ù–µ —Ç—Ä–æ–≥–∞–µ—Ç:**
- –ê–Ω–æ–Ω–∏–º–Ω—ã–µ –±–ª–æ–∫–∏ (*U...)
- XREF –±–ª–æ–∫–∏ (—Å —Å–∏–º–≤–æ–ª–æ–º |)

---

#### `LY_Xref_Layers.lsp`

**–ö–æ–º–∞–Ω–¥–∞: CHXA**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö XREF —Å–ª–æ–µ–≤.

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –ü–µ—Ä–≤—ã–π –ø—Ä–æ—Ö–æ–¥ - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞:
   ‚îú‚îÄ‚îÄ vla-get-layers ‚Üí –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å–ª–æ–µ–≤
   ‚îú‚îÄ‚îÄ vlax-for ‚Üí –æ–±—Ö–æ–¥ –≤—Å–µ—Ö —Å–ª–æ–µ–≤
   ‚îú‚îÄ‚îÄ –§–∏–ª—å—Ç—Ä: vl-string-search "|" (XREF —Å–ª–æ–∏)
   ‚îú‚îÄ‚îÄ vla-put-color ‚Üí 146 (—Å–µ—Ä–æ-–≥–æ–ª—É–±–æ–π)
   ‚îî‚îÄ‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ XREF —Å–ª–æ–µ–≤

2. –í—Ç–æ—Ä–æ–π –ø—Ä–æ—Ö–æ–¥ - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏:
   ‚îú‚îÄ‚îÄ command "._-layer"
   ‚îú‚îÄ‚îÄ –î–ª—è –∫–∞–∂–¥–æ–≥–æ XREF —Å–ª–æ—è:
   ‚îÇ   ‚îî‚îÄ‚îÄ "_transparency" "50" <layer_name>
   ‚îî‚îÄ‚îÄ command "" (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)

3. –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è:
   ‚îî‚îÄ‚îÄ command "REGENALL"
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –¶–≤–µ—Ç: 146 (—Å–µ—Ä–æ-–≥–æ–ª—É–±–æ–π)
- –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å: 50

**–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è XREF —Å–ª–æ–µ–≤:** –Ω–∞–ª–∏—á–∏–µ —Å–∏–º–≤–æ–ª–∞ `|` –≤ –∏–º–µ–Ω–∏ —Å–ª–æ—è.

---

### UT_ - Utility Tools (–£—Ç–∏–ª–∏—Ç—ã)

#### `UT_Export_To_CSV.lsp`

**–ö–æ–º–∞–Ω–¥—ã:**

| –ö–æ–º–∞–Ω–¥–∞ | –†–µ–∂–∏–º | –§–∞–π–ª |
|---------|-------|------|
| `EXPORTCSV` | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –¥–∏–∞–ª–æ–≥–æ–º | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç |
| `EXPORTEXCEL` | –ê–≤—Ç–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ –≤ Excel | `%TEMP%\<dwgname>_<random>.csv` |

**–ê–ª–≥–æ—Ä–∏—Ç–º EXPORTEXCEL:**
```
1. –ó–∞–ø—Ä–æ—Å –≤—ã–±–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (ssget)

2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É:
   ‚îú‚îÄ‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —á–µ—Ä—Ç–µ–∂–∞: getvar "DWGNAME"
   ‚îú‚îÄ‚îÄ –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è .dwg
   ‚îú‚îÄ‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞: rem MILLISECS 99999
   ‚îî‚îÄ‚îÄ –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–∏:
       ‚îî‚îÄ‚îÄ %TEMP%\<DWGNAME>_<random>.csv

3. –°–æ–∑–¥–∞–Ω–∏–µ CSV —Ñ–∞–π–ª–∞ (open "w")

4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞:
   ‚îú‚îÄ‚îÄ AcDbBlockReference ‚Üí export-block
   ‚îÇ   ‚îú‚îÄ‚îÄ –ò–º—è –±–ª–æ–∫–∞, X, Y, Z
   ‚îÇ   ‚îî‚îÄ‚îÄ –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã (–≤ –ø–æ—Ä—è–¥–∫–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è)
   ‚îÇ
   ‚îú‚îÄ‚îÄ AcDbLine ‚Üí export-line
   ‚îÇ   ‚îú‚îÄ‚îÄ 2 —Å—Ç—Ä–æ–∫–∏ (start point + end point)
   ‚îÇ   ‚îî‚îÄ‚îÄ X, Y, Z, length, handle, layer
   ‚îÇ
   ‚îú‚îÄ‚îÄ AcDbCircle ‚Üí export-circle
   ‚îÇ   ‚îî‚îÄ‚îÄ Center X, Y, Z, radius, handle, layer
   ‚îÇ
   ‚îú‚îÄ‚îÄ AcDbArc ‚Üí export-arc
   ‚îÇ   ‚îú‚îÄ‚îÄ ArcStart: X, Y, Z
   ‚îÇ   ‚îú‚îÄ‚îÄ ArcEnd: X, Y, Z
   ‚îÇ   ‚îú‚îÄ‚îÄ ArcCenter: X, Y, Z
   ‚îÇ   ‚îî‚îÄ‚îÄ ArcRadius
   ‚îÇ
   ‚îú‚îÄ‚îÄ AcDbPolyline ‚Üí export-polyline
   ‚îÇ   ‚îú‚îÄ‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ 2D/3D (–ø–æ –¥–ª–∏–Ω–µ –º–∞—Å—Å–∏–≤–∞)
   ‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç—Ä–æ–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã
   ‚îÇ
   ‚îú‚îÄ‚îÄ AcDbText/MText ‚Üí export-text
   ‚îÇ   ‚îî‚îÄ‚îÄ X, Y, Z, text content (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
   ‚îÇ
   ‚îú‚îÄ‚îÄ AcDbPoint ‚Üí export-point
   ‚îÇ   ‚îî‚îÄ‚îÄ X, Y, Z
   ‚îÇ
   ‚îî‚îÄ‚îÄ AcDbDimension ‚Üí export-dimension
       ‚îî‚îÄ‚îÄ Measurement value

5. –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞

6. –ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ (–µ—Å–ª–∏ EXPORTEXCEL):
   ‚îî‚îÄ‚îÄ startapp "cmd" "/c start \"\" \"<filepath>\""
```

**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `format-num` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞ (4 –∑–Ω–∞–∫–∞)
- `csv-escape` - —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ CSV (–∑–∞–ø—è—Ç—ã–µ, –∫–∞–≤—ã—á–∫–∏)

**–§–æ—Ä–º–∞—Ç CSV:**
```
BlockName,X,Y,Z,Attr1,Attr2,...
LINE,X1,Y1,Z1,Length,,,,Handle,Layer
LINE,X2,Y2,Z2,Length,,,,Handle,Layer
CIRCLE,CenterX,CenterY,CenterZ,Radius,,,,Handle,Layer
```

---

## üîß –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | Persistence |
|-----------|------|----------|-------------|
| `*main-lsp-path*` | MainLoader | –ü—É—Ç—å –∫ MainLoader.lsp | Session |
| `*main-lsp-dir*` | MainLoader | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ | Session |
| `*lsp-files*` | MainLoader | –°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ | Session |
| `*POP-LAST-NUM*` | BL_Insert_Block_To_Points | –ü–æ—Å–ª–µ–¥–Ω–∏–π –Ω–æ–º–µ—Ä | ‚úÖ Persistent |
| `*POP-CIRCLE-MODE*` | BL_Insert_Block_To_Points | –†–µ–∂–∏–º –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–µ–π (A/C/Q) | ‚úÖ Persistent |
| `*CIRCLE-MODE-ASKED*` | BL_Insert_Block_To_Points | –§–ª–∞–≥ –∑–∞–ø—Ä–æ—Å–∞ —Ä–µ–∂–∏–º–∞ | Command-local |
| `*sbp-selection*` | BL_Select_Blocks_On_Line | –ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ | ‚úÖ Persistent |

---

## üìê –¢–∏–ø—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

### –ü–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

| –û–±—ä–µ–∫—Ç | POP | Export CSV | Deviation | Intersection |
|--------|-----|-----------|-----------|--------------|
| POINT | ‚úÖ | ‚úÖ | - | - |
| LINE | ‚úÖ | ‚úÖ | ‚úÖ (–æ–ø–æ—Ä–Ω—ã–π) | - |
| LWPOLYLINE | ‚úÖ | ‚úÖ | ‚úÖ (–æ–ø–æ—Ä–Ω—ã–π) | ‚úÖ |
| POLYLINE (3D) | ‚úÖ | ‚úÖ | ‚úÖ (–æ–ø–æ—Ä–Ω—ã–π) | ‚úÖ |
| CIRCLE | ‚úÖ | ‚úÖ | ‚úÖ (–æ–ø–æ—Ä–Ω—ã–π) | - |
| ARC | - | ‚úÖ | ‚úÖ (–æ–ø–æ—Ä–Ω—ã–π) | - |
| SPLINE | - | - | ‚úÖ (–æ–ø–æ—Ä–Ω—ã–π) | - |
| TEXT | - | ‚úÖ | - | - |
| MTEXT | - | ‚úÖ | - | - |
| INSERT (–±–ª–æ–∫) | - | ‚úÖ | ‚úÖ (—Ü–µ–ª–µ–≤–æ–π) | - |
| DIMENSION | - | ‚úÖ | - | - |

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –†–∞–±–æ—Ç–∞ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –±–ª–æ–∫–æ–≤

**–ú–µ—Ç–æ–¥—ã –¥–æ—Å—Ç—É–ø–∞:**

```lisp
; –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ entget/entmod (–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π)
(setq e (entnext blk))  ; –ü–µ—Ä–≤–∞—è —Å—É—â–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ INSERT
(while e
  (setq ent (entget e))
  (if (= (cdr (assoc 0 ent)) "ATTRIB")
    (if (= (strcase (cdr (assoc 2 ent))) "HEIGHT")
      (entmod (subst (cons 1 new-val) (assoc 1 ent) ent))
    )
  )
  (setq e (entnext e))
)

; –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ VLA (–≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π)
(setq vBlock (vlax-ename->vla-object blk))
(foreach att (vlax-invoke vBlock 'GetAttributes)
  (if (= (strcase (vla-get-TagString att)) "HEIGHT")
    (vla-put-TextString att new-val)
  )
)
```

**–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–∞ –º–µ—Ç–æ–¥–∞:**
- VLA: BL_Insert_Block_To_Points, AT_Attribute_Visibility, DV_Deviation_Tools
- entget/entmod: AT_Attribute_Tools

---

### 2. –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª–∏–ª–∏–Ω–∏—è–º–∏

**–¢–∏–ø—ã –ø–æ–ª–∏–ª–∏–Ω–∏–π:**

```lisp
; LWPOLYLINE (2D)
; - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: —Å–ø–∏—Å–æ–∫ –ø–∞—Ä (X,Y) –≤ DXF –∫–æ–¥–µ 10
; - Bulge: DXF –∫–æ–¥ 42 (–¥–ª—è –¥—É–≥)
; - –ó–∞–º–∫–Ω—É—Ç–æ—Å—Ç—å: DXF –∫–æ–¥ 70, –±–∏—Ç 0

; POLYLINE (2D/3D)
; - –ó–∞–≥–æ–ª–æ–≤–æ–∫: INSERT-–ø–æ–¥–æ–±–Ω—ã–π –æ–±—ä–µ–∫—Ç
; - –í–µ—Ä—à–∏–Ω—ã: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å VERTEX —Å—É—â–Ω–æ—Å—Ç–µ–π
; - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ: SEQEND
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ:**

| –§–∞–π–ª | LWPOLYLINE | POLYLINE |
|------|-----------|----------|
| BL_Insert_Block_To_Points | ‚úÖ (DXF –∫–æ–¥ 10) | ‚úÖ (VERTEX) |
| BL_Select_Blocks_On_Line | ‚úÖ (—Å bulge‚Üíarc) | - |
| PT_Points_Intersection | ‚úÖ (Coordinates) | ‚úÖ (Coordinates) |

---

### 3. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤

**–°–∏—Å—Ç–µ–º–∞ –º–∞—Å—à—Ç–∞–±–æ–≤ –≤ POP:**

```lisp
CANNOSCALE (—Ç–µ–∫—É—â–∏–π –º–∞—Å—à—Ç–∞–± –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π) ‚Üí –º–∞—Å—à—Ç–∞–± –±–ª–æ–∫–∞

"1:2000" ‚Üí 1.44
"1:1000" ‚Üí 0.72
"1:500"  ‚Üí 0.36
"1:250"  ‚Üí 0.18
"1:100"  ‚Üí 0.08
"1:50"   ‚Üí 0.04
"1:25"   ‚Üí 0.02
Default  ‚Üí 0.2
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –í—Å–µ –±–ª–æ–∫–∏ M1502 –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –º–∞—Å—à—Ç–∞–±–æ–º –ø–æ X, Y, Z.

---

### 4. Unicode –≤ –∞—Ç—Ä–∏–±—É—Ç–∞—Ö

**–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã:**

```lisp
"\U+0394"  ‚Üí Œî (–¥–µ–ª—å—Ç–∞, –≥—Ä–µ—á–µ—Å–∫–∞—è)
"\U+2534"  ‚Üí ‚î¥ (–ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä, box drawing)
"E"        ‚Üí East (–≤–æ—Å—Ç–æ–∫)
"N"        ‚Üí North (—Å–µ–≤–µ—Ä)
```

**–ü—Ä–∏–º–µ—Ä—ã:**
- `Œî‚î¥=0.05` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ–µ
- `ŒîE=1.05` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ –æ—Å–∏ X (–≤–æ—Å—Ç–æ–∫)
- `ŒîN=0.14` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ –æ—Å–∏ Y (—Å–µ–≤–µ—Ä)

---

### 5. –¢–æ–ª–µ—Ä–∞–Ω—Å—ã –∏ —Ç–æ—á–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | Tolerance | –§–∞–π–ª |
|----------|-----------|------|
| –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –±–ª–æ–∫–æ–≤ | –¢–æ—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ | DelDupBlocks |
| –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ –Ω–∞ –ª–∏–Ω–∏–∏ | 0.1 | BL_Select_Blocks_On_Line |
| –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ | 1e-6 (–¥–µ—Ç–µ—Ä–º–∏–Ω–∞–Ω—Ç) | PT_Points_Intersection |
| –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ | 1e-5 (–¥—É–±–ª–∏–∫–∞—Ç—ã) | PT_Points_Intersection |
| –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ | 1e-6 | DV_Deviation_Tools |
| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π | 2 –∑–Ω–∞–∫–∞ | DV_Deviation_Tools |

---

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **DelDupBlocks: –ù–µ—Ç —Ç–æ–ª–µ—Ä–∞–Ω—Å–∞**
   ```lisp
   ; –¢–µ–∫—É—â–∏–π –∫–æ–¥:
   (if (member pos seen) ...)  ; –¢–æ—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

   ; –ü—Ä–æ–±–ª–µ–º–∞: –ë–ª–æ–∫–∏ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ 0.0001 –∏ 0.0002 –Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
   ```

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

2. **POP: –ñ–µ—Å—Ç–∫–∏–π –ø—É—Ç—å –∫ –±–ª–æ–∫—É**
   ```lisp
   (setq blk-path "C:\\LDOCS\\BLOCKS\\M1502.dwg")
   ; –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö –±–µ–∑ C:\LDOCS\
   ```

3. **Unicode –≤ –∞—Ç—Ä–∏–±—É—Ç–∞—Ö**
   ```lisp
   ; –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —à—Ä–∏—Ñ—Ç—ã AutoCAD –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç Unicode
   ; –°–∏–º–≤–æ–ª ‚î¥ (U+2534) - box drawing character –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Consolas
   ; –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à—Ä–∏—Ñ—Ç Arial Unicode MS, Segoe UI –∏–ª–∏ ISOCPEUR
   ; –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å PDF –ø—Ä–∏–Ω—Ç–µ—Ä: Properties ‚Üí Custom Properties ‚Üí Embed all fonts
   ```

4. **VBA –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   ```lisp
   ; –ö–æ–º–∞–Ω–¥—ã HK: hi, MM, RB —Ç—Ä–µ–±—É—é—Ç VBA –º–∞–∫—Ä–æ—Å–æ–≤
   ; –ü—Ä–æ–±–ª–µ–º–∞: VBA –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ AutoCAD –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å –≤–µ—Ä—Å–∏–∏ 2021
   ```

---

## üöÄ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ì–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∞—è —Å—ä–µ–º–∫–∞

```
1. –ò–º–ø–æ—Ä—Ç —Ç–æ—á–µ–∫ –∏–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (TXT2PT)
   ‚îî‚îÄ‚îÄ –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç–º–µ—Ç–∫–∏ ‚Üí 3D —Ç–æ—á–∫–∏

2. –ù—É–º–µ—Ä–∞—Ü–∏—è —Ç–æ—á–µ–∫ (POP)
   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä —Ç–æ—á–µ–∫
   ‚îú‚îÄ‚îÄ –í—Å—Ç–∞–≤–∫–∞ –±–ª–æ–∫–æ–≤ M1502
   ‚îî‚îÄ‚îÄ –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ: –Ω–æ–º–µ—Ä + –≤—ã—Å–æ—Ç–∞

3. –†–∞—Å—á–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (SetDeltaDAL)
   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ M1502
   ‚îú‚îÄ‚îÄ –í—ã–±–æ—Ä –æ–ø–æ—Ä–Ω–æ–π –ª–∏–Ω–∏–∏/–ø–æ–ª–∏–ª–∏–Ω–∏–∏
   ‚îî‚îÄ‚îÄ –ó–∞–ø–∏—Å—å Œî‚ä• –≤ –∞—Ç—Ä–∏–±—É—Ç DELTA

4. –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel (EXPORTEXCEL)
   ‚îî‚îÄ‚îÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Ç–∞–±–ª–∏—Ü—ã
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–∞–±–æ—Ç–∞ —Å –±–ª–æ–∫–∞–º–∏ –Ω–∞ —Ç—Ä–∞—Å—Å–µ

```
1. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ –Ω–∞ –ø–æ–ª–∏–ª–∏–Ω–∏–∏ (POP)
   ‚îî‚îÄ‚îÄ –ë–ª–æ–∫–∏ M1502 –Ω–∞ –≤—Å–µ—Ö –≤–µ—Ä—à–∏–Ω–∞—Ö

2. –ü–µ—Ä–µ–Ω–æ—Å –≤—ã—Å–æ—Ç —Å 3D –ø–æ–ª–∏–ª–∏–Ω–∏–∏ (PB3)
   ‚îî‚îÄ‚îÄ Z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –±–ª–æ–∫–æ–≤ = Z –ø–æ–ª–∏–ª–∏–Ω–∏–∏

3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–∑ –≤—ã—Å–æ—Ç (AttToZMulti)
   ‚îî‚îÄ‚îÄ –ê—Ç—Ä–∏–±—É—Ç HEIGHT = Z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –±–ª–æ–∫–∞

4. –í—ã–±–æ—Ä –±–ª–æ–∫–æ–≤ –≤ –∑–æ–Ω–µ (SBP)
   ‚îî‚îÄ‚îÄ –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª–∏–ª–∏–Ω–∏–π
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—á–∏—Å—Ç–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —á–µ—Ä—Ç–µ–∂–∞

```
1. –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (DelDupBlocks)
   ‚îî‚îÄ‚îÄ –û—á–∏—Å—Ç–∫–∞ –±–ª–æ–∫–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ByLayer (SetAllByLayer)
   ‚îî‚îÄ‚îÄ –í—Å–µ –æ–±—ä–µ–∫—Ç—ã + –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–æ–≤ ‚Üí —Ü–≤–µ—Ç ByLayer

3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ XREF —Å–ª–æ–µ–≤ (CHXA)
   ‚îú‚îÄ‚îÄ –¶–≤–µ—Ç: 146 (—Å–µ—Ä–æ-–≥–æ–ª—É–±–æ–π)
   ‚îî‚îÄ‚îÄ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å: 50

4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ—á–µ–∫ (PTT)
   ‚îî‚îÄ‚îÄ PDMODE=99, PDSIZE=0.3
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ .lsp | 15 |
| –í—Å–µ–≥–æ –∫–æ–º–∞–Ω–¥ | 36 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ) | ~3000 |
| –ì–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö | 7 |
| DCL –¥–∏–∞–ª–æ–≥–æ–≤ | 1 |
| VBA –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | 3 |
| –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ | 11 |

### –ö–æ–º–∞–Ω–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–∞–Ω–¥ |
|-----------|-------------------|
| Hotkeys | 10 |
| Block Tools | 10 |
| Attribute Tools | 3 |
| Point Tools | 6 |
| Deviation Tools | 3 |
| Layer Tools | 2 |
| Utility Tools | 2 |
| **–í–°–ï–ì–û** | **36** |

---

## üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏

```
MainLoader.lsp (–∫–æ—Ä–µ–Ω—å)
‚îÇ
‚îú‚îÄ‚îÄ HK_Hotkeys.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: VBA –º–∞–∫—Ä–æ—Å—ã (hi, MM, RB)
‚îÇ
‚îú‚îÄ‚îÄ BL_Block_Tools.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: vla-get-ModelSpace
‚îÇ
‚îú‚îÄ‚îÄ BL_Copy_Attributes_Properties.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –ö–æ–ø–∏—Ä—É–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏
‚îÇ
‚îú‚îÄ‚îÄ BL_Delete_Duplicate_Blocks.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ
‚îú‚îÄ‚îÄ BL_Select_Blocks_On_Line.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: *sbp-selection* (persistent)
‚îÇ
‚îú‚îÄ‚îÄ BL_Insert_Block_To_Points.lsp (–∫–ª—é—á–µ–≤–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: C:\LDOCS\BLOCKS\M1502.dwg
‚îÇ   ‚îú‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: *POP-LAST-NUM*, *POP-CIRCLE-MODE*
‚îÇ   ‚îî‚îÄ‚îÄ –°–æ–∑–¥–∞–µ—Ç: –°–ª–æ–π M1502
‚îÇ
‚îú‚îÄ‚îÄ AT_Attribute_Tools.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –†–∞–±–æ—Ç–∞–µ—Ç —Å: –∞—Ç—Ä–∏–±—É—Ç–æ–º HEIGHT
‚îÇ
‚îú‚îÄ‚îÄ AT_Attribute_Visibility.lsp
‚îÇ   ‚îî‚îÄ‚îÄ –¢—Ä–µ–±—É–µ—Ç: AT_Attribute_Visibility.dcl
‚îÇ
‚îú‚îÄ‚îÄ PT_Point_Tools.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ
‚îú‚îÄ‚îÄ PT_Points_Intersection.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ
‚îú‚îÄ‚îÄ PT_Point_At_Block_Center.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ –°–æ–∑–¥–∞–µ—Ç —Ç–æ—á–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –±–ª–æ–∫–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ DV_Deviation_Tools.lsp
‚îÇ   ‚îî‚îÄ‚îÄ –†–∞–±–æ—Ç–∞–µ—Ç —Å: –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ DELTA, DELTA_X, DELTA_Y
‚îÇ
‚îú‚îÄ‚îÄ LY_Set_All_By_Layer.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ
‚îú‚îÄ‚îÄ LY_Xref_Layers.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
‚îÇ
‚îî‚îÄ‚îÄ UT_Export_To_CSV.lsp (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π)
    ‚îî‚îÄ‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: getvar "DWGNAME"
```

---

## üí° –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ

### 1. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –û–¥–∏–Ω —Ñ–∞–π–ª = –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- –ü—Ä–µ—Ñ–∏–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥—É–ª–∏ –±–µ–∑ –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 2. Persistence –¥–∞–Ω–Ω—ã—Ö
```lisp
; –ü—Ä–∞–≤–∏–ª—å–Ω–æ: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
(if (not *POP-LAST-NUM*) (setq *POP-LAST-NUM* 1))

; –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏ –∫–æ–º–∞–Ω–¥
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```lisp
; –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
(if (not ss)
  (progn (princ "\nNo objects selected!") (exit))
)

; vl-catch-all-apply –¥–ª—è VLA –æ–ø–µ—Ä–∞—Ü–∏–π
(setq layer_name (vl-catch-all-apply 'vla-get-name (list layer_obj)))
```

### 4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```lisp
; –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
(princ "\nProcessing 15 objects...")
(princ ".")  ; –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

; –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
(princ (strcat "\nDone! Last number: " prefix (itoa num) suffix))
```

---

## üìù –°–æ–≥–ª–∞—à–µ–Ω–∏—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥
- –ö–æ—Ä–æ—Ç–∫–∏–µ hotkeys: 2-3 —Å–∏–º–≤–æ–ª–∞ (CT, PC, rv)
- –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ: PascalCase (SetAttFromText, DelDupBlocks)
- –ê–∫—Ä–æ–Ω–∏–º—ã: UPPERCASE (POP, SBP, PTT)

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
```lisp
; –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: c:<NAME>
(defun c:POP ...)

; –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: kebab-case
(defun process-point ...)
(defun get-block-scale ...)
(defun point-on-segment ...)

; –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: –ª–æ–∫–∞–ª—å–Ω—ã–µ –≤ defun
(defun c:SetDeltaDAL ( / xy-only fmt2 ...)
  (defun xy-only (pt) ...)
  (defun fmt2 (x) ...)
  ...
)
```

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
```lisp
;;; –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–∞–π–ª–∞: 3 —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
;;; –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è

;; –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: 2 —Ç–æ—á–∫–∏ —Å –∑–∞–ø—è—Ç–æ–π
(defun c:POP ...

  ; –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –±–ª–æ–∫—É: 1 —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π
  (setq scale (get-block-scale))
)
```

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ AutoCAD

**–í–∞—Ä–∏–∞–Ω—Ç 1: acad.lsp (–∑–∞–≥—Ä—É–∑–∫–∞ –æ–¥–∏–Ω —Ä–∞–∑)**
```lisp
; –§–∞–π–ª: C:\Users\<username>\AppData\Roaming\Autodesk\AutoCAD <version>\acad.lsp
(load "c:/1/MainLoader.lsp")
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: acaddoc.lsp (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞)**
```lisp
; –§–∞–π–ª: C:\Users\<username>\AppData\Roaming\Autodesk\AutoCAD <version>\acaddoc.lsp
(load "c:/1/MainLoader.lsp")
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**
- AutoCAD —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π LISP
- Visual LISP Extensions (vl-load-com)
- –ü–∞–ø–∫–∞ `c:\1\` —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:**
- –ë–ª–æ–∫ M1502: `C:\LDOCS\BLOCKS\M1502.dwg` (–¥–ª—è POP)
- VBA –¥–ª—è AutoCAD (–¥–ª—è –∫–æ–º–∞–Ω–¥ hi, MM, RB)
- Excel (–¥–ª—è –∞–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏—è CSV)

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π

```lisp
; –í –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ AutoCAD:
Command: (c:LoadAllLSP)

; –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
Loading HK_Hotkeys.lsp... OK
Loading BL_Block_Tools.lsp... OK
...
===BRICK LISP LOADED===
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```lisp
Command: !*main-lsp-dir*
"c:/1/"

Command: !*POP-LAST-NUM*
1

Command: !*POP-CIRCLE-MODE*
"A"
```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

**1. –ë–ª–æ–∫ M1502 –Ω–µ –Ω–∞–π–¥–µ–Ω**
```
Error: Block M1502 not found
–†–µ—à–µ–Ω–∏–µ: –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É C:\LDOCS\BLOCKS\ –∏ –ø–æ–º–µ—Å—Ç–∏—Ç—å M1502.dwg
```

**2. VBA –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
```
Unknown command "VBARUN"
–†–µ—à–µ–Ω–∏–µ: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å VBA –¥–ª—è AutoCAD
```

---

## üéì –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å

### –¢–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

**1. –†–∞–±–æ—Ç–∞ —Å selection sets**
```lisp
; –°–æ–∑–¥–∞–Ω–∏–µ
(setq ss (ssget))

; –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
(setq ss (ssget '((0 . "INSERT"))))

; –ò—Ç–µ—Ä–∞—Ü–∏—è
(setq i 0)
(while (< i (sslength ss))
  (setq ent (ssname ss i))
  ...
  (setq i (1+ i))
)
```

**2. VLA vs DXF**
```lisp
; VLA: –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
(setq vBlock (vlax-ename->vla-object blk))
(vla-get-InsertionPoint vBlock)

; DXF: –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π
(setq data (entget blk))
(cdr (assoc 10 data))
```

**3. –†–µ–∫—É—Ä—Å–∏—è**
```lisp
; –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
(defun process-block-recursive (blkname)
  ...
  (if nested-block
    (process-block-recursive nested-name)
  )
)
```

**4. –ó–∞–º—ã–∫–∞–Ω–∏—è (closures)**
```lisp
; –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –≤–Ω–µ—à–Ω–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
(defun c:SetDeltaDAL ( / xy-only fmt2 ...)
  (defun xy-only (pt) (list (car pt) (cadr pt) 0.0))
  (setq pNearest (xy-only insPt))  ; –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
)
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è AutoCAD LISP

- **DXF Codes:** https://help.autodesk.com/view/OARX/2024/ENU/?guid=GUID-A2A628B0-3699-4740-A215-C560E7242F63
- **Visual LISP:** https://help.autodesk.com/view/OARX/2024/ENU/?guid=GUID-A0E9D801-8BE9-4BF1-85E8-3807E15F3B71
- **ActiveX/VLA:** https://help.autodesk.com/view/OARX/2024/ENU/?guid=GUID-36BF58F3-537D-4B59-BEFE-2D0FEF5A4443

### –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç–µ–º—ã

- **Bulge to Arc:** –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è bulge –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥—É–≥–∏
- **Segment Intersection:** –ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ—Ç—Ä–µ–∑–∫–æ–≤ (–ª–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞)
- **DCL Dialog:** –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤

---

## üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)

1. **–î–æ–±–∞–≤–∏—Ç—å tolerance –≤ DelDupBlocks**
   ```lisp
   (defun points-equal-p (p1 p2 tol)
     (and (< (abs (- (car p1) (car p2))) tol)
          (< (abs (- (cadr p1) (cadr p2))) tol)
          (< (abs (- (caddr p1) (caddr p2))) tol))
   )
   ```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (—É–ª—É—á—à–µ–Ω–∏—è)

2. **–°–¥–µ–ª–∞—Ç—å –ø—É—Ç—å –∫ M1502.dwg –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º**
   ```lisp
   (if (not *M1502-BLOCK-PATH*)
     (setq *M1502-BLOCK-PATH* "C:\\LDOCS\\BLOCKS\\M1502.dwg")
   )
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å undo –≤ –∫–æ–º–∞–Ω–¥—ã**
   ```lisp
   (defun c:POP (/ *error* ...)
     (defun *error* (msg)
       (command "._UNDO" "_E")
       ...
     )
     (command "._UNDO" "_BE")
     ...
     (command "._UNDO" "_E")
   )
   ```

4. **–°–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Unicode —à—Ä–∏—Ñ—Ç–æ–≤**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —à—Ä–∏—Ñ—Ç–∞ –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)

5. **–≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç GeoJSON**
   - –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ CSV —ç–∫—Å–ø–æ—Ä—Ç—É

6. **–ò–º–ø–æ—Ä—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ CSV**
   - –û–±—Ä–∞—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∫ EXPORTCSV

7. **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä—Ç–µ–∂–µ–π**
   - ScriptPro –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –∫ –º–Ω–æ–∂–µ—Å—Ç–≤—É —Ñ–∞–π–ª–æ–≤

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ

**–ê–≤—Ç–æ—Ä:** –ù–µ —É–∫–∞–∑–∞–Ω
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –Ø–Ω–≤–∞—Ä—å 2026 (–≤–µ—Ä—Å–∏—è 2.0)
**–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:** `c:\1\`

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ Claude Code –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞.*
*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-18*
*–ò–∑–º–µ–Ω–µ–Ω–∏—è:*
- *–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω BL_Copy_Attributes_Properties.lsp –∏–∑ Git –∏—Å—Ç–æ—Ä–∏–∏ (–∫–æ–º–∞–Ω–¥–∞ COPYATTPROP)*
- *–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 15 —Ñ–∞–π–ª–æ–≤, 36 –∫–æ–º–∞–Ω–¥, ~3100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞*
- *–î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è Unicode —Å–∏–º–≤–æ–ª–æ–≤ –≤ PDF (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ –∏ –ø—Ä–∏–Ω—Ç–µ—Ä–∞)*
- *–ó–∞–º–µ–Ω–µ–Ω —Å–∏–º–≤–æ–ª ‚ä• (U+22A5) –Ω–∞ ‚î¥ (U+2534) –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —à—Ä–∏—Ñ—Ç–æ–º Consolas –≤ PDF*
- *–î–æ–±–∞–≤–ª–µ–Ω –º–æ–¥—É–ª—å PT_Point_At_Block_Center.lsp —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ PTBC –∏ PTBCM*
